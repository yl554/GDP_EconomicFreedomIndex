---
title: "What Makes a Strong GDP?"
subtitle: "Regression Analysis"
author: "Rtists"
date: "11/14/2019"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r libraries}
library(tidyverse)
library(readxl)
library(skimr)
library(tidyr)
library(magrittr)
library(broom)
library(leaps)
library(knitr) 
library(rms)
```


```{r data, warning=FALSE}
economic_data <- read_excel("/cloud/project/02-data/economic_data.xlsx",
col_types = c("text", "text", "text",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric"))
```


Your regression analysis results go here. At a minimum, the regression analysis should include the following: 

- Statement of the research question and modeling obejctive (prediction, inference, etc.)
- Description of the response variable
- Updated exploratory data analysis, incorporating any feedback from the proposal
- Explanation of the modeling process and why you chose those metohds, incorporating any feedback from the proposal
- Output of the final model
- Discussion of the assumptions for the final model
- Interpretations / interesting findings from the model coefficients
- Additional work of other models or analylsis not included in the final model.

*Use proper headings as needed.*

### Question and Objective

In this investigation, our goal is to try to understand what aspects of a country's economy are most associated with the GDP of the country. GDP is one of the most foundational measures of economic growth and the size of an economy, and as a result the majority of governments are extremely interested in understanding what contributes to having a large GDP. This study tries to help governments answer that question by investigating the research question: "What indicators of a country's economy have the greatest effect on the country's GDP?"

Since we already have data on all the countries and are thus don't need to try to "predict" the GDP of a country that may not be in our dataset, our modeling objective isn't prediction but rather inference, since we are trying to understand which predictor variable has the greatest effect on the response. Additionally, the modeling objective is inference as we are using our data set to build a model that reliably chooses the correct identifiers of GDP from a set of more variables than we may potentially need.

### Response Variable

In our investigation, the response value is GDP; that is, we are trying to determine the effect of various predictors on the GDP of countries. GDP represents the final value of all finished goods and services produced in a country in 2019, and in this case, in US dollars. However, according to the EDA conducted below, since the distribution of GDP's is incredibly right-skewed (countries such as the US and China have enormous GDP's matched by no other countries), we will be building the model using the log of GDP as our response.

### Exploratory Data Analysis

We will begin our exploratory data analysis by cleaning the data. We notice a total of 12 countries which have a "NA" value for one or more of the predictor variables that we will investigate. We will omit these entries from our analysis, but we expect this to add a slight bias to our results; the below 12 countries are all developing and thus our model may fit developed countries better than developing countries. However, the 12 countries below also have unusual governmental and economic structures as well as poor data quality associated with them; including them in the model may also significantly influence the coefficients associated with predictors. Thus, we have decided to leave them out of the model.

```{r NA-removal}
economic_data %>%
  filter(complete.cases(economic_data)==FALSE) %>%
  select(Country)
```
```{r omit-NA}
economic_data <- na.omit(economic_data)
```

### Response Variable

Now that the data has been cleaned, we can begin exploring our response variable.

```{r gdp-vis}
ggplot(data = economic_data, mapping = aes(x = GDP)) +
  geom_histogram(binwidth = 1000, fill = "cornflowerblue") +
  labs(x = "GDP (billions of USD)",
       y = "Frequency",
       title = "Distribution of GDPs")

economic_data %>%
select(GDP) %>%
skim()
```

The distribution of GDP shows significant right skew, which is reasonable and expected as the world has countries such as the US and China who, due to their population and industrial advantages, have significantly greater GDP's than the average country. We will now show a graph of GDP with some of these influential points removed.

```{r GDP without Outlier}
economic_data_temp <- economic_data %>% select(GDP) %>% filter(GDP < 3000)

ggplot(data = economic_data_temp, mapping = aes(x = GDP)) +
  geom_histogram(fill = "cornflowerblue") +
  labs(x = "GDP (billions of USD)",
       y = "Frequency",
       title = "Distribution of GDPs")

economic_data %>%
select(GDP) %>%
skim()
```

The distribution of GDP is unimodal and right-skewed. Since the media and interquartile range are less influenced by outliers, we report them as measures of center and spread. The median of the distribution is 88.9 billion and the interquartile range is 411.3. THe values are in billions of dollars.

This calls for a log-transform of the response variable, whose distribution is visualized below:

```{r log-gdp-vis}
ggplot(data = economic_data, mapping = aes(x = log(GDP))) +
  geom_histogram(binwidth = 1, fill = "cornflowerblue") +
  labs(x = "log(GDP)",
       y = "Frequency",
       title = "Distribution of log-GDPs")

economic_data <- economic_data %>%
  mutate(logGDP = log(GDP))

economic_data %>%
select(logGDP) %>%
skim()
```

This distribution of logGDP is normal and unimodal. We will likely use this as our response variable. Since there is minimal skewing and the distribution is generally symmetric, we report the mean and standard deviation as measures of center and spread. The mean logGDP is 4.61 and the standard deviation of its distribution is 2.08. 

### Predictor Variables

We will now look at each of the 12 predictor variables that we will use to predict GDP, starting with `TaxBurden`.

```{r Tax Burden}
ggplot(data = economic_data, mapping = aes(x = TaxBurden)) +
  geom_histogram(binwidth = 2, fill = "cornflowerblue") + 
  labs(x = "Tax Burden (% of Country's GDP)",
       y = "Frequency",
       title = "Distribution of Tax Burden")

economic_data %>%
select(TaxBurden) %>%
skim()
```

`TaxBurden` represents the amount of tax paid by the citizens of a country as a proportion of the GDP of that country. The distribution of tax burden is unimodal and only slightly right skewed. The mode is around 14-15%. In general, the tax burden across countries appears normally distributed. The mean tax burden is 22.19 and the standard deviation of the distribution is 10.17. 

```{r Government Spending}
ggplot(data = economic_data, mapping = aes(x = GovSpending)) +
  geom_histogram(binwidth = 3, fill = "cornflowerblue") + 
  labs(x = "Government Spending (% of Country's GDP)",
       y = "Frequency",
       title = "Distribution of Government Spending")

economic_data %>%
select(GovSpending) %>%
skim()
```

`GovSpending` represents the amount spent by the government as a percentage of the GDP of the country. The distribution of government spending is generally symmmetric and unimodal. There are several outliers which have significantly higher government spending: with government spending either equal to or more than 100% of the country's GDP. The mode of the distribution is around 25%. Since there is minimal skewing, we report the mean and standard deviation. The mean government spending is 33.87 and the distribution has a standard deviation of 15.52.

```{r Population}
ggplot(data = economic_data, mapping = aes(x = Population)) +
  geom_histogram(binwidth = 40, fill = "cornflowerblue") + 
  labs(x = "Population (Million)",
       y = "Frequency",
       title = "Distribution of Population")

economic_data %>%
select(Population) %>%
skim()
```

`Population` represents the number of individuals living in a country. The distribution of population is unimodal and right-skewed. Because there are two influential points in "population", we will plot another graph of population without these two points below.

```{r Population without Outlier}
economic_data_temp <- economic_data %>% select(Population) %>% filter(Population < 500)

ggplot(data = economic_data_temp, mapping = aes(x = Population)) +
  geom_histogram(binwidth = 10, fill = "cornflowerblue") + 
  labs(x = "Population (Million)",
       y = "Frequency",
       title = "Distribution of Population")

economic_data %>%
select(Population) %>%
skim()
```

The distribution of population is unimodal and right-skewed. The mode of the distribution is around 1 million. Since the median and IQR are more robust to skewing, we report them instead as a measures of center and spread. The median is 9.15 and the IQR is 26.85. Additionally, when conducting our analysis, we may need to apply a log-transform to make the distribution of the variable more normal; based on a pairs plot, population has a logarithmic relationship with logGDP and thus we will apply a logarithmic transform to population below.

```{r logpop}
economic_data <- economic_data %>%
  mutate(logpop=log(Population))

ggplot(data=economic_data, aes(x=logpop)) +
  geom_histogram(fill = "cornflowerblue") +
  labs(title="Distribution of logpop", x="Log(Population)")
```

Based on the above plot, the logarithmic transformation has been successful in normalizing the population variable as well as creating a more linear relationship with GDP. 

```{r Unemployment}
ggplot(data = economic_data, mapping = aes(x = Unemployment)) +
  geom_histogram(binwidth = 1, fill = "cornflowerblue") + 
  labs(x = "Unemployment (%)",
       y = "Frequency",
       title = "Distribution of Unemployment")

economic_data %>%
select(Unemployment) %>%
skim()
```

`Unemployment` represents the percantage of the workforce of a country that is currently not working. The distribution of unemployment is unimodal and right-skewed. The mode of the distribution is around 4-5%. Since the median and IQR are more robust to skewing, we report them instead as a measures of center and spread. The median is 5.7 and the IQR is 5.6.

```{r Inflation}
ggplot(data = economic_data, mapping = aes(x = Inflation)) +
  geom_histogram(fill = "cornflowerblue") + 
  labs(x = "Inflation (%)",
       y = "Frequency",
       title = "Distribution of Inflation")

economic_data_temp <- economic_data %>% select(Inflation) %>% filter(Inflation < 100)
ggplot(data = economic_data_temp, mapping = aes(x = Inflation)) +
  geom_histogram(binwidth = 1, fill = "cornflowerblue") + 
  labs(x = "Inflation (%)",
       y = "Frequency",
       title = "Distribution of Inflation without Outlier")

economic_data %>%
select(Inflation) %>%
skim()
```

`Inflation` represents the change in prices of goods and services in a year in the country. The first distribution of inflation rates includes all outliers. Because of the size and resolution of the diagram, the distribution of most economies are not visible. The second diagram shows the distribution of inflation rates without the outlier with more than 1000% inflation. The distribution of inflation rate is generally unimodal and right skewed. The mode of the distribution is around 2%. Given significant skewing, we report the median and IQR as measures of center and spread. The median inflation rate is 2.7% and the IQR is 4%. Because of this skew, we may need to log-transform this variable as well to get its distribution to be more normal.


```{r Region}
regional <- economic_data %>%
  group_by(Region) %>%
  tally() %>%
  mutate(prop = n*100/nrow(economic_data))

ggplot(data = economic_data, mapping = aes(x = Region)) +
  geom_bar(fill = "cornflowerblue") + 
  labs(x = "Region",
       y = "Frequency",
       title = "Distribution of Region")

ggplot(mapping = aes(x = "", y = prop, fill = Region), data = regional) +
    geom_bar(stat = "identity", color = "white") +
    coord_polar("y", start = 0) +
    theme_void()
```

`Region` represents the geographical continent/area that the country is situated in. The bar graph and piechart of `Region` shows that there is a relatively equal representation of countries from different regions of the world. The Americas, Asia-Pacific, Sub-Saharan Africa, and Europe each represent around 25% of all the countries in the data. The smallest representation is from the Middle East and North Africa at 8.1%. We are not too concerned with the distribution because there are 195 countries in the world and our data has 173 countries. The difference in distribution across region is likely to be largely reflective of the actual geographical distribution of nation-states.

```{r Government Interference}
ggplot(mapping = aes(x = GovInterference), data = economic_data) +
  geom_bar(fill = "cornflowerblue") +
  labs(title = "Bar Graph of Government Inteference in Economy", x  = "Levels of Government Interference", y = "Frequency")
```

`GovInterference` represents the amount of interference that the government has in the economy as determined by the World Economic Index. The distribution of government interference shows that most countries either have extensive or moderate government inteference. The mode of the distribution is moderate government interference. Economies with limited and repressive intervention are significanly lesser, each having around 10-15 countries. We do not report the center or spread here because government interference is a categorical variable.

```{r Tariff Rate}
ggplot(mapping = aes(x = TariffRate), data = economic_data) + 
  geom_histogram(binwidth = 1, fill = "cornflowerblue") +
  labs(title = "Histogram of Tariff Rate", x  = "Tariff Rate", y = "Frequency")

economic_data %>%
  select(TariffRate) %>%
  skim()
```

`TariffRate` represents the average percentage tax on imports that the country has outstanding as of 2019. The distribution of tariff rate is generally right skewed and unimodal. There are several outlier economies with 50% tariff rate such as Central African Republic and North Korea. The mode of the distribution is around 2%. The median tariff rate is 4.3 and the interquartile range of the distribution is 6.7. Because of this right-skew, log-transforming this variable might be necessary.

```{r Income Tax Rate}
ggplot(mapping = aes(x = IncomeTaxRate), data = economic_data) +
  geom_histogram(binwidth = 5, fill = "cornflowerblue") +
  labs(title = "Histogram of Income Tax Rate", x  = "Income Tax Rate", y = "Frequency")

economic_data %>%
  select(IncomeTaxRate) %>%
  skim()
```

`IncomeTaxRate` represents the average tax rate applied to individuals on their incomes. The distribution of income tax rate is unimodal and generally symmetric. While its general shape resembles a normal distribution, there are several values of income tax rate which have particularly high frequency such as 10%, 25% and 34-35%. The mode of the distribution occurs at 35%. Since there is relatively minimal skewing, we report the mean and standard deviation as measures of center and spread. The mean income tax rate is 28.23 and the standard deviation of the distribution is 13.4. 

```{r Corporate Tax Rate}
ggplot(mapping = aes(x = CorporateTaxRate), data = economic_data) +
geom_histogram(binwidth = 4, fill = "cornflowerblue") +
labs(title = "Histogram of Corporate Tax Rate", x  = "Corporate Tax Rate", y = "Frequency")

economic_data %>%
select(CorporateTaxRate) %>%
skim()
```

`CorporateTaxRate` represents the average tax rate applied to corporations on their revenues. The distribution of corporate tax rate is unimodal and only slightly right skewed. The mode of the distribution is around 28-30%. Since there is minimal skewing, we report the mean and the standard deviation as measures of center and spread. The mean corporate tax rate is 23.89% and the standard deviation is 8.88%.

```{r Public Debt}
ggplot(data = economic_data, mapping = aes(x = PublicDebt)) +
  geom_histogram(binwidth = 8, fill = "cornflowerblue") + 
  labs(x = "Public Debt (% of GDP)",
       y = "Frequency",
       title = "Distribution of Public Debt")

economic_data %>%
select(PublicDebt) %>%
skim()
```

`PublicDebt` represents the debt of the country as a percentage of the country's GDP. The distribution of public debt is unimodal and right skewed. There are several outliers with public debt more than 175%. The mode of the distribution is around 30%. The median public debt is 49.4% and the interquartile range is 35%.


```{r inflation-categorize}
economic_data <- economic_data %>%
  mutate(cat_inflation = case_when(
Inflation >= 6 ~ "Dangerously High",
Inflation <6 & Inflation >3 ~ "High",
Inflation <= 3 & Inflation >=1 ~ "Healthy",
Inflation <1 ~ "Low"))
economic_data%>%
  group_by(cat_inflation) %>%
  count()

economic_data <- economic_data %>%
  mutate(cat_inflation = as.factor(cat_inflation))

economic_data %>%
ggplot(mapping = aes(x = cat_inflation, y = logGDP)) +
  geom_boxplot(position="dodge")

skim(economic_data)
```


```{r mean center variables}
economic_data <- economic_data %>%
  mutate(TaxBurdenCent = TaxBurden - mean(TaxBurden))
economic_data <- economic_data %>%
  mutate(GovSpendingCent = GovSpending - mean(GovSpending))
economic_data <- economic_data %>%
  mutate(PopulationCent = Population - mean(Population))
```

### Methods & Modelling

```{r setting healthy as baseline, echo=TRUE}
economic_data <- economic_data %>%
  mutate(cat_inflation = relevel(cat_inflation, ref = "Healthy", ordered = FALSE))
```

```{r Modeling AIC, echo=TRUE}
aic_full_model <- lm(logGDP ~ TariffRate + logpop + Unemployment + cat_inflation + PublicDebt + GovSpendingCent + IncomeTaxRate + CorporateTaxRate + TaxBurdenCent + GDPGrowth, data = economic_data)

aic_model <- step(aic_full_model, direction = "backward")

tidy(aic_model, conf.int="TRUE") %>%
  kable(format="markdown", conf.level = 0.95)
```

```{r BIC Model, echo=TRUE}
regfit_backward <- regsubsets(logGDP ~ TariffRate + logpop + Unemployment + cat_inflation + PublicDebt + GovSpendingCent + IncomeTaxRate + CorporateTaxRate + TaxBurdenCent + GDPGrowth, data = economic_data, method="backward")

sel_summary <- summary(regfit_backward)
coef(regfit_backward, which.min(sel_summary$bic))
```

```{r adjr2 Model, echo=TRUE}
sel_summary <- summary(regfit_backward)
coef(regfit_backward, which.max(sel_summary$adjr2))
```

AIC: logGDP ~ TariffRate + logpop + CorporateTaxRate + TaxBurdenCent + GDPGrowth + Unemployment + GovSpendingCent + cat_inflationDangerouslyHigh + cat_inflationHigh + cat_inflationLow       
    
BIC: logGDP ~  TariffRate + logpop + CorporateTaxRate + TaxBurdenCent + GDPGrowth + cat_inflationDangerouslyHigh + cat_inflationHigh               

adjR2: logGDP ~ TariffRate + logpop + CorporateTaxRate + TaxBurdenCent + GDPGrowth + Unemployment + cat_inflationDangerously High + cat_inflationHigh  

From the final equations generated using different selection criteria, we see that all three selection criteria included TariffRate + logpop + CorporateTaxRate + TaxBurdenCent + GDPGrowth in the final model. cat_inflation is included in all three equations, though for BIC and adjR2, the level of low inflation is excluded. This is not surprising considering that the p-value of the cat_inflationLow coefficient is 0.9783542, implying that this coefficient is statistically insignificant. We will choose to include cat_inflation in the final model for the following reasons. One, a categorical variable with 4 levels require us to use 3 dummy variables. Removing one because it is insignificant will affect the coefficients of the other levels because the missing level has to be forcibly added to either of the three category. We will also not change the categories of inflation rates because the present classification references economic literature which generally suggests four levels of inflation rates: low, healthy, high, and dangerously high (hyperinflation). Two, we also note that the AIC coefficient for cat_inflationLow to be extremely small. This means that the regression model only made very minimal changes to fit the data categorized as Low inflation, thus we are not too concerned that the inclusion of this level will significantly impact the accuracy of the regression. 

Unemployment is only shown in the AIC equation while GovSpendingCent is included in both the AIC and adjR2 equations. We conduct a nested F test to finally decide if these two predictor variables are significant to the existing model.

```{r Nested F for Unemployment, echo=TRUE}
reduced <- lm(logGDP ~ TariffRate + logpop + CorporateTaxRate + TaxBurdenCent + GDPGrowth + cat_inflation, data = economic_data)
full <- lm(logGDP ~ TariffRate + logpop + CorporateTaxRate + TaxBurdenCent + GDPGrowth + cat_inflation + Unemployment, data = economic_data)
kable(anova(reduced, full), format="markdown", digits = 3)
```
```{r Nested F for GovSpendingCent, echo=TRUE}
reduced <- lm(logGDP ~ TariffRate + logpop + CorporateTaxRate + TaxBurdenCent + GDPGrowth + cat_inflation, data = economic_data)
full <- lm(logGDP ~ TariffRate + logpop + CorporateTaxRate + TaxBurdenCent + GDPGrowth + cat_inflation + GovSpendingCent, data = economic_data)
kable(anova(reduced, full), format="markdown", digits = 3)
```

As observed in the individual nested F tests of GovSpendingCent and Unemployment, both variables have relatively high p-values. This means that both predictor variables are not statistically significant predictors. We also do not accord them high practical significance for the following reasons. While unemployment does affect and is affected by gdp growth rate, it theoretically may not have considerable impact on GDP (GDP is a stock concept, gdp growth is a flow concept). This is not surprising since countries with high GDP may have high or low unemployment depending on their respective trajectories in the business cycle. The role of government spending is also highly contested in economic literature. That it is not a significant determinant of GDP reflect this ambuiguity in academic literature.

```{r Nested F for interaction GDPGrowth, echo=TRUE}
reduced <- lm(logGDP ~ TariffRate + logpop + CorporateTaxRate + TaxBurdenCent + GDPGrowth + cat_inflation, data = economic_data)
full <- lm(logGDP ~ TariffRate + logpop + CorporateTaxRate + TaxBurdenCent + GDPGrowth + cat_inflation + cat_inflation*GDPGrowth, data = economic_data)
kable(anova(reduced, full), format="markdown", digits = 3)
```
```{r Nested F for interaction TaxBurdenCent, echo=TRUE}
reduced <- lm(logGDP ~ TariffRate + logpop + CorporateTaxRate + TaxBurdenCent + GDPGrowth + cat_inflation, data = economic_data)
full <- lm(logGDP ~ TariffRate + logpop + CorporateTaxRate + TaxBurdenCent + GDPGrowth + cat_inflation + cat_inflation*CorporateTaxRate, data = economic_data)
kable(anova(reduced, full), format="markdown", digits = 3)
```
```{r Nested F for interaction CorporateTaxRate, echo=TRUE}
reduced <- lm(logGDP ~ TariffRate + logpop + CorporateTaxRate + TaxBurdenCent + GDPGrowth + cat_inflation, data = economic_data)
full <- lm(logGDP ~ TariffRate + logpop + CorporateTaxRate + TaxBurdenCent + GDPGrowth + cat_inflation + cat_inflation*CorporateTaxRate, data = economic_data)
kable(anova(reduced, full), format="markdown", digits = 3)
```

```{r Nested F for interaction logpop, echo=TRUE}
reduced <- lm(logGDP ~ TariffRate + logpop + CorporateTaxRate + TaxBurdenCent + GDPGrowth + cat_inflation, data = economic_data)
full <- lm(logGDP ~ TariffRate + logpop + CorporateTaxRate + TaxBurdenCent + GDPGrowth + cat_inflation + cat_inflation*logpop, data = economic_data)
kable(anova(reduced, full), format="markdown", digits = 3)
```

```{r Nested F for interaction TariffRate, echo=TRUE}
reduced <- lm(logGDP ~ TariffRate + logpop + CorporateTaxRate + TaxBurdenCent + GDPGrowth + cat_inflation, data = economic_data)
full <- lm(logGDP ~ TariffRate + logpop + CorporateTaxRate + TaxBurdenCent + GDPGrowth + cat_inflation + cat_inflation*TariffRate, data = economic_data)
kable(anova(reduced, full), format="markdown", digits = 3)
```

### Final Model

```{r Final Model, echo=TRUE}
final_model <- lm(logGDP ~ TariffRate + logpop + CorporateTaxRate + TaxBurdenCent + GDPGrowth + cat_inflation, data=economic_data)
kable(tidy(final_model,conf.int=TRUE),format="html",digits=3)
```
```{r VIF, echo=TRUE}
tidy(vif(final_model))
```
#### Create the model

#### Model Diagnostics
(influential points, leverage points)
After we have the model built up, the next task is to examine the model assumptions: linearity, constant variance, normality, and independence. We can see from the scatterplot matrix of response variable vs. every predictor variable that there is indeed some linear relationship between them after twe take log transformation of suspicious variables like population. So, the linearity assumption is satisfied. Now we plot the residuals to check for constant variance assumption.

```{r residual vs. predicted}
economic_data <- economic_data %>% 
  mutate(predicted = predict.lm(final_model), residuals = resid(final_model))

ggplot(data=economic_data,aes(x=predicted, y=residuals)) + 
  geom_point() + 
  geom_hline(yintercept=0,color="red") +
  labs(title="Residuals vs. Predicted Values")
```

This is the scatterplot of residuals vs. predicted GDP values. There doen't seem to be a distinguishable shape. The residuals appear to randomly scattered in the plot.

Then we plot the residuals vs. each predictor variable to further check for constant variance assumption.

```{r residuals vs. predictor variables}
ggplot(data=economic_data,aes(x=TariffRate, y=residuals)) + 
  geom_point() + 
  geom_hline(yintercept=0,color="red") +
  labs(x = "TariffRate", 
       y = "Residuals",
       title = "Scatterplot of Residuals vs. TariffRate")

ggplot(data=economic_data,aes(x=logpop, y=residuals)) + 
  geom_point() + 
  geom_hline(yintercept=0,color="red") +
  labs(x = "log of Population", 
       y = "Residuals",
       title = "Scatterplot of Residuals vs. log of Population")

ggplot(data=economic_data,aes(x=CorporateTaxRate, y=residuals)) + 
  geom_point() + 
  geom_hline(yintercept=0,color="red") +
  labs(x = "CorporateTaxRate", 
       y = "Residuals",
       title = "Scatterplot of Residuals vs. CorporateTaxRate")

ggplot(data=economic_data,aes(x=GDPGrowth, y=residuals)) + 
  geom_point() + 
  geom_hline(yintercept=0,color="red") +
  labs(x = "GDPGrowth", 
       y = "Residuals",
       title = "Scatterplot of Residuals vs. GDPGrowth")

ggplot(data=economic_data,aes(x=cat_inflation,y=residuals)) + 
  geom_boxplot() + 
  geom_hline(yintercept=0,color="red") +
  labs(x = "Inflation", 
       y="Residuals")
```

```{r residual normality check}
ggplot(data = economic_data, aes(x = residuals)) +
  geom_histogram(binwidth = 0.2)+
  labs(x = "Residuals",
       y = "Frequency of Given Residual",
       title = "Histogram of Residuals")

ggplot(data=economic_data, aes(sample=residuals)) + 
  stat_qq() + 
  stat_qq_line() +
  labs(title="Normal QQ Plot of Residuals")
```

```{r augment model}
economic_data_aug <- augment(final_model) %>%
  mutate(obs_num = row_number())

glimpse(head(economic_data_aug, n=5))
```

```{r leverage}
leverage_threshold <- 2*(8+1)/nrow(economic_data)

ggplot(data = economic_data_aug, aes(x = obs_num ,y = .hat)) + 
  geom_point(alpha = 0.7) + 
  geom_hline(yintercept = leverage_threshold,color = "red")+
  labs(x = "Observation Number",y = "Leverage",title = "Leverage") +
  geom_text(aes(label=ifelse(.hat > leverage_threshold, as.character(obs_num), "")), nudge_x = 4)

nrow(economic_data_aug %>% filter(.hat > leverage_threshold))
```

```{r cook distace}
ggplot(data = economic_data_aug, aes(x = obs_num, y = .cooksd)) + 
  geom_point(alpha = 0.7) + 
  geom_hline(yintercept=1,color = "red")+
  labs(x= "Observation Number",y = "Cook's Distance",title = "Cook's Distance") +
  geom_text(aes(label = ifelse(.hat>1,as.character(obs_num),"")))
```

```{r standardized residuals}
ggplot(data = economic_data_aug, aes(x = .fitted,y = .std.resid)) +
  geom_point(alpha = 0.7) + 
  geom_hline(yintercept = 0,color = "red") +
  geom_hline(yintercept = -2,color = "red",linetype = "dotted") +
  geom_hline(yintercept = 2,color = "red",linetype = "dotted") +
  labs(x ="Predicted Value",y ="Standardized Residuals",title = "Standardized Residuals vs. Predicted") +
  geom_text(aes(label = ifelse(abs(.std.resid) >2,as.character(obs_num),"")), nudge_x = 0.3)
```

```{r }
```

### Discusson of Assumptions

### Interpretation and Other Interesting Findings

### Additional Information