---
title: "What Makes a Strong GDP?"
subtitle: "Regression Analysis"
author: "Rtists"
date: "11/14/2019"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r libraries}
library(tidyverse)
library(readxl)
library(skimr)
```


```{r data, warning=FALSE}
economic_data <- read_excel("/cloud/project/02-data/economic_data.xlsx",
col_types = c("text", "text", "text",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric"))
```


Your regression analysis results go here. At a minimum, the regression analysis should include the following: 

- Statement of the research question and modeling obejctive (prediction, inference, etc.)
- Description of the response variable
- Updated exploratory data analysis, incorporating any feedback from the proposal
- Explanation of the modeling process and why you chose those metohds, incorporating any feedback from the proposal
- Output of the final model
- Discussion of the assumptions for the final model
- Interpretations / interesting findings from the model coefficients
- Additional work of other models or analylsis not included in the final model.

*Use proper headings as needed.*

### Question and Objective

In this investigation, our goal is to try to understand what aspects of a country's economy are most associated with the GDP of the country. GDP is one of the most foundational measures of economic growth and the size of an economy, and as a result the majority of governments are extremely interested in understanding what contributes to having a large GDP. This study tries to help governments answer that question by investigating the research question: "What indicators of a country's economy have the greatest effect on the country's GDP?"

Since we already have data on all the countries and are thus don't need to try to "predict" the GDP of a country that may not be in our dataset, our modeling objective isn't prediction but rather inference, since we are trying to understand which predictor variable has the greatest effect on the response. Additionally, the modeling objective is inference as we are using our data set to build a model that reliably chooses the correct identifiers of GDP from a set of more variables than we may potentially need.

### Response Variable

### Exploratory Data Analysis

We will begin our exploratory data analysis by cleaning the data. We notice a total of 12 countries which have a "NA" value for one or more of the predictor variables that we will investigate. We will omit these entries from our analysis, but we expect this to add a slight bias to our results; the below 12 countries are all developing and thus our model may fit developed countries better than developing countries. 

```{r NA-removal}
economic_data %>%
  filter(complete.cases(economic_data)==FALSE) %>%
  select(Country)
```
```{r omit-NA}
economic_data <- na.omit(economic_data)
```

Now that the data has been cleaned, we can begin exploring our predictor variables.
We will now look at each of the 12 predictor variables that we will use to predict GDP, starting with `TaxBurden`.

```{r Tax Burden}
ggplot(data = economic_data, mapping = aes(x = TaxBurden)) +
  geom_histogram(binwidth = 2, fill = "cornflowerblue") + 
  labs(x = "Tax Burden (% of Country's GDP)",
       y = "Frequency",
       title = "Distribution of Tax Burden")

economic_data %>%
select(TaxBurden) %>%
skim()
```

`TaxBurden` represents the amount of tax paid by the citizens of a country as a proportion of the GDP of that country. The distribution of tax burden is unimodal and only slightly right skewed. The mode is around 14-15%. In general, the tax burden across countries appears normally distributed. The mean tax burden is 22.19 and the standard deviation of the distribution is 10.17. 

```{r Government Spending}
ggplot(data = economic_data, mapping = aes(x = GovSpending)) +
  geom_histogram(binwidth = 3, fill = "cornflowerblue") + 
  labs(x = "Government Spending (% of Country's GDP)",
       y = "Frequency",
       title = "Distribution of Government Spending")

economic_data %>%
select(GovSpending) %>%
skim()
```

`GovSpending` represents the amount spent by the government as a percentage of the GDP of the country. The distribution of government spending is generally symmmetric and unimodal. There are several outliers which have significantly higher government spending: with government spending either equal to or more than 100% of the country's GDP. The mode of the distribution is around 25%. Since there is minimal skewing, we report the mean and standard deviation. The mean government spending is 33.87 and the distribution has a standard deviation of 15.52.

```{r Population}
ggplot(data = economic_data, mapping = aes(x = Population)) +
  geom_histogram(binwidth = 40, fill = "cornflowerblue") + 
  labs(x = "Population (Million)",
       y = "Frequency",
       title = "Distribution of Population")

economic_data %>%
select(Population) %>%
skim()
```

`Population` represents the number of individuals living in a country. The distribution of population is unimodal and right-skewed. Because there are two influential points in "population", we will plot another graph of population without these two points below.

```{r Population without Outlier}
economic_data_temp <- economic_data %>% select(Population) %>% filter(Population < 500)

ggplot(data = economic_data_temp, mapping = aes(x = Population)) +
  geom_histogram(binwidth = 10, fill = "cornflowerblue") + 
  labs(x = "Population (Million)",
       y = "Frequency",
       title = "Distribution of Population")

economic_data %>%
select(Population) %>%
skim()
```

The distribution of population is unimodal and right-skewed. The mode of the distribution is around 1 million. Since the median and IQR are more robust to skewing, we report them instead as a measures of center and spread. The median is 9.15 and the IQR is 26.85. Additionally, when conducting our analysis, we may need to apply a log-transform to make the distribution of the variable more normal; based on a pairs plot, population has a logarithmic relationship with logGDP and thus we will apply a logarithmic transform to population below.

```{r logpop}
economic_data <- economic_data %>%
  mutate(logpop=log(Population))

ggplot(data=economic_data, aes(x=logpop)) +
  geom_histogram(fill = "cornflowerblue") +
  labs(title="Distribution of logpop", x="Log(Population)")
```

Based on the above plot, the logarithmic transformation has been successful in normalizing the population variable as well as creating a more linear relationship with GDP. 

```{r Unemployment}
ggplot(data = economic_data, mapping = aes(x = Unemployment)) +
  geom_histogram(binwidth = 1, fill = "cornflowerblue") + 
  labs(x = "Unemployment (%)",
       y = "Frequency",
       title = "Distribution of Unemployment")

economic_data %>%
select(Unemployment) %>%
skim()
```

`Unemployment` represents the percantage of the workforce of a country that is currently not working. The distribution of unemployment is unimodal and right-skewed. The mode of the distribution is around 4-5%. Since the median and IQR are more robust to skewing, we report them instead as a measures of center and spread. The median is 5.7 and the IQR is 5.6.

```{r Inflation}
ggplot(data = economic_data, mapping = aes(x = Inflation)) +
  geom_histogram(fill = "cornflowerblue") + 
  labs(x = "Inflation (%)",
       y = "Frequency",
       title = "Distribution of Inflation")

economic_data_temp <- economic_data %>% select(Inflation) %>% filter(Inflation < 100)
ggplot(data = economic_data_temp, mapping = aes(x = Inflation)) +
  geom_histogram(binwidth = 1, fill = "cornflowerblue") + 
  labs(x = "Inflation (%)",
       y = "Frequency",
       title = "Distribution of Inflation without Outlier")

economic_data %>%
select(Inflation) %>%
skim()
```

`Inflation` represents the change in prices of goods and services in a year in the country. The first distribution of inflation rates includes all outliers. Because of the size and resolution of the diagram, the distribution of most economies are not visible. The second diagram shows the distribution of inflation rates without the outlier with more than 1000% inflation. The distribution of inflation rate is generally unimodal and right skewed. The mode of the distribution is around 2%. Given significant skewing, we report the median and IQR as measures of center and spread. The median inflation rate is 2.7% and the IQR is 4%. Because of this skew, we may need to log-transform this variable as well to get its distribution to be more normal.


```{r Region}
regional <- economic_data %>%
  group_by(Region) %>%
  tally() %>%
  mutate(prop = n*100/nrow(economic_data))

ggplot(data = economic_data, mapping = aes(x = Region)) +
  geom_bar(fill = "cornflowerblue") + 
  labs(x = "Region",
       y = "Frequency",
       title = "Distribution of Region")

ggplot(mapping = aes(x = "", y = prop, fill = Region), data = regional) +
    geom_bar(stat = "identity", color = "white") +
    coord_polar("y", start = 0) +
    theme_void()
```

`Region` represents the geographical continent/area that the country is situated in. The bar graph and piechart of `Region` shows that there is a relatively equal representation of countries from different regions of the world. The Americas, Asia-Pacific, Sub-Saharan Africa, and Europe each represent around 25% of all the countries in the data. The smallest representation is from the Middle East and North Africa at 8.1%. We are not too concerned with the distribution because there are 195 countries in the world and our data has 173 countries. The difference in distribution across region is likely to be largely reflective of the actual geographical distribution of nation-states.

```{r Government Interference}
ggplot(mapping = aes(x = GovInterference), data = economic_data) +
  geom_bar(fill = "cornflowerblue") +
  labs(title = "Bar Graph of Government Inteference in Economy", x  = "Levels of Government Interference", y = "Frequency")
```

`GovInterference` represents the amount of interference that the government has in the economy as determined by the World Economic Index. The distribution of government interference shows that most countries either have extensive or moderate government inteference. The mode of the distribution is moderate government interference. Economies with limited and repressive intervention are significanly lesser, each having around 10-15 countries. We do not report the center or spread here because government interference is a categorical variable.

```{r Tariff Rate}
ggplot(mapping = aes(x = TariffRate), data = economic_data) + 
  geom_histogram(binwidth = 1, fill = "cornflowerblue") +
  labs(title = "Histogram of Tariff Rate", x  = "Tariff Rate", y = "Frequency")

economic_data %>%
  select(TariffRate) %>%
  skim()
```

`TariffRate` represents the average percentage tax on imports that the country has outstanding as of 2019. The distribution of tariff rate is generally right skewed and unimodal. There are several outlier economies with 50% tariff rate such as Central African Republic and North Korea. The mode of the distribution is around 2%. The median tariff rate is 4.3 and the interquartile range of the distribution is 6.7. Because of this right-skew, log-transforming this variable might be necessary.

```{r Income Tax Rate}
ggplot(mapping = aes(x = IncomeTaxRate), data = economic_data) +
  geom_histogram(binwidth = 5, fill = "cornflowerblue") +
  labs(title = "Histogram of Income Tax Rate", x  = "Income Tax Rate", y = "Frequency")

economic_data %>%
  select(IncomeTaxRate) %>%
  skim()
```

`IncomeTaxRate` represents the average tax rate applied to individuals on their incomes. The distribution of income tax rate is unimodal and generally symmetric. While its general shape resembles a normal distribution, there are several values of income tax rate which have particularly high frequency such as 10%, 25% and 34-35%. The mode of the distribution occurs at 35%. Since there is relatively minimal skewing, we report the mean and standard deviation as measures of center and spread. The mean income tax rate is 28.23 and the standard deviation of the distribution is 13.4. 

```{r Corporate Tax Rate}
ggplot(mapping = aes(x = CorporateTaxRate), data = economic_data) +
geom_histogram(binwidth = 4, fill = "cornflowerblue") +
labs(title = "Histogram of Corporate Tax Rate", x  = "Corporate Tax Rate", y = "Frequency")

economic_data %>%
select(CorporateTaxRate) %>%
skim()
```

`CorporateTaxRate` represents the average tax rate applied to corporations on their revenues. The distribution of corporate tax rate is unimodal and only slightly right skewed. The mode of the distribution is around 28-30%. Since there is minimal skewing, we report the mean and the standard deviation as measures of center and spread. The mean corporate tax rate is 23.89% and the standard deviation is 8.88%.

```{r Public Debt}
ggplot(data = economic_data, mapping = aes(x = PublicDebt)) +
  geom_histogram(binwidth = 8, fill = "cornflowerblue") + 
  labs(x = "Public Debt (% of GDP)",
       y = "Frequency",
       title = "Distribution of Public Debt")

economic_data %>%
select(PublicDebt) %>%
skim()
```

`PublicDebt` represents the debt of the country as a percentage of the country's GDP. The distribution of public debt is unimodal and right skewed. There are several outliers with public debt more than 175%. The mode of the distribution is around 30%. The median public debt is 49.4% and the interquartile range is 35%.


```{r inflation-categorize}
economic_data <- economic_data %>%
  mutate(cat_inflation = case_when(
Inflation >= 6 ~ "Dangerously High",
Inflation <6 & Inflation >3 ~ "High",
Inflation <= 3 & Inflation >=1 ~ "Healthy",
Inflation <1 & Inflation>0 ~ "Low",
Inflation <= 0 ~ "Deflation"
  ))
economic_data%>%
  group_by(cat_inflation) %>%
  count()

skim(economic_data)
```





```{r mean center variables}
economic_data <- economic_data %>%
  mutate(TaxBurdenCent = TaxBurden - mean(TaxBurden))
economic_data <- economic_data %>%
  mutate(GovSpendingCent = GovSpending - mean(GovSpending))
economic_data <- economic_data %>%
  mutate(PopulationCent = Population - mean(Population))
```
### Methods & Modelling

### Final Model

#### Create the model

#### Model Diagnostics
(influential points, leverage points)

### Discusson of Assumptions

### Interpretation and Other Interesting Findings

### Additional Information