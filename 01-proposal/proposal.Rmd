---
title: "PROJECT TITLE"
subtitle: "Project Proposal"
author: "Rtists"
date: "2019/10/26"
output: github_document
---

```{r libraries}
library(tidyverse)
library(readxl)
```


```{r data}
economic_data <- read_excel("/cloud/project/02-data/economic_data.xlsx",
col_types = c("text", "text", "text",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric"))

happiness_data <- read_excel("/cloud/project/02-data/happiness_data.xlsx")

country_data <- full_join(economic_data, happiness_data, by = "Country")
```

## Section 1. Introduction


## Section 2. Regression Analysis

```{r glimpse}
glimpse(country_data)
```

We first take an overview of the data. We can see that there are 193 observations --- one observation corresponds to one country, and 16 variables, including country name, 14 predictor variables and one response variable that we want to predict, the happiness score.

```{r Tax Burden}
ggplot(data = country_data, mapping = aes(x = TaxBurden)) +
  geom_histogram() + 
  labs(x = "Tax Burden (% of Country's GDP)",
       y = "Frequency",
       title = "Distribution of Tax Burden")
```

```{r Government Spending}
ggplot(data = country_data, mapping = aes(x = GovSpending)) +
  geom_histogram(binwidth = 4) + 
  labs(x = "Government Spending (% of Country's GDP)",
       y = "Frequency",
       title = "Distribution of Government Spending")
```

```{r Population}
ggplot(data = country_data, mapping = aes(x = Population)) +
  geom_histogram(binwidth = 40) + 
  labs(x = "Population (Million)",
       y = "Frequency",
       title = "Distribution of Population")
```

```{r Unemployment}
ggplot(data = country_data, mapping = aes(x = Unemployment)) +
  geom_histogram(binwidth = 1) + 
  labs(x = "Unemployment (%)",
       y = "Frequency",
       title = "Distribution of Unemployment")
```

```{r Inflation}
ggplot(data = country_data, mapping = aes(x = Inflation)) +
  geom_histogram() + 
  labs(x = "Inflation (%)",
       y = "Frequency",
       title = "Distribution of Inflation")
```

```{r Region}
aggregate(cbind(count = Region) ~ Region, data = economic_data, FUN = function(x){NROW(x)})

regional = data.frame("Region" = c("Americas","Asia-Pacific","Europe","Middle East and North Africa","Sub-Saharan Africa"), "share" = c(32, 43, 45, 18, 47))
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF", "#99D492")
ggplot(mapping = aes(x = "", y = share, fill = Region), data = regional) +
    geom_bar(stat = "identity", color = "white") +
    coord_polar("y", start = 0) +
    scale_fill_manual(values = mycols) +
    theme_void()
```

```{r Government Interference}
ggplot(mapping = aes(x = GovInterference), data = economic_data) +
geom_bar(fill = "cornflowerblue") +
labs(title = "Bar Graph of Government Inteference in Economy", x  = "Levels of Government Interference", y = "Frequency")
```

```{r Tariff Rate}
ggplot(mapping = aes(x = TariffRate), data = economic_data) +
geom_histogram(fill = "cornflowerblue") +
labs(title = "Histogram of Tariff Rate", x  = "Tariff Rate", y = "Frequency")
```

```{r Income Tax Rate}
ggplot(mapping = aes(x = IncomeTaxRate), data = economic_data) +
geom_histogram(fill = "cornflowerblue") +
labs(title = "Histogram of Income Tax Rate", x  = "Income Tax Rate", y = "Frequency")
```

```{r Corporate Tax Rate}
ggplot(mapping = aes(x = CorporateTaxRate), data = economic_data) +
geom_histogram(fill = "cornflowerblue") +
labs(title = "Histogram of Corporate Tax Rate", x  = "Corporate Tax Rate", y = "Frequency")
```

```{r Inflation without outlier}
country_data_temp <- country_data %>% select(Inflation) %>% filter(Inflation < 100)
ggplot(data = country_data_temp, mapping = aes(x = Inflation)) +
  geom_histogram(binwidth = 1) + 
  labs(x = "Inflation (%)",
       y = "Frequency",
       title = "Distribution of Inflation without Outlier")
```

```{r Public Debt}
ggplot(data = country_data, mapping = aes(x = PublicDebt)) +
  geom_histogram(binwidth = 8) + 
  labs(x = "Public Debt (% of GDP)",
       y = "Frequency",
       title = "Distribution of Public Debt")
```



## Section 3. Regression Analysis Plan

## Section 4. References

## The Data